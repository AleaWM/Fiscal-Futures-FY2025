[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "FY2025 Fiscal Futures Annual Report",
    "section": "",
    "text": "1 FY2025 preliminary site",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>FY2025 preliminary site</span>"
    ]
  },
  {
    "objectID": "Everything_changepensions.html",
    "href": "Everything_changepensions.html",
    "title": "2  FY2025 Report Images and Tables",
    "section": "",
    "text": "2.1 Modify Expenditure File",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>FY2025 Report Images and Tables</span>"
    ]
  },
  {
    "objectID": "Everything_changepensions.html#modify-expenditure-file",
    "href": "Everything_changepensions.html#modify-expenditure-file",
    "title": "2  FY2025 Report Images and Tables",
    "section": "",
    "text": "2.1.1 Tax refunds\nAggregate expenditures: Save tax refunds as negative revenue. Code refunds to match the rev_type codes\n\n02 = income taxes, fund 0278\n\n03 = corporate income taxes, fund 0946, 0380\n\n06 = sales tax\n\n09 = motor fuel tax, fund 0436, 0012\n\n24 = insurance taxes and fees\n\n35 = all other tax refunds.\n\n0121 estate tax refund\nAviation fuel refund fund, fund 0946 cannabis Excise Tax Refund, fund 0912 Rental Purchase agreement Refund 0671\nWhat we want:\n- To exclude refunds as expenditures from our expenditure totals.\n- Exclude funds that hold refund funds from both revenue and expenditure sides\n- Revenue neutral unless budget tricks are occurring\n- still want to examine refunds over time to compare to past years calculations\n\n\nCode\ntax_refund_long &lt;- exp_temp %&gt;%           # fund != \"0401\" # removes State Trust Funds\n  filter(fund != \"0401\" &\n           (object == \"9900\" | object==\"9910\"|object==\"9921\"|object==\"9923\"|object==\"9925\")) %&gt;%\n  # keeps these objects which represent revenue, insurance, treasurer,and financial and professional reg tax refunds\n  mutate(refund = case_when(\n    object == \"9900\" & fund == \"0278\" ~ \"FY23_Rebates\",\n    fund==\"0278\" & sequence == \"00\" ~ \"02\", # for income tax refund\n    fund==\"0278\" & sequence == \"01\" ~ \"03\", # tax administration and enforcement and tax operations become corporate income tax refund\n        fund==\"0380\" ~ \"03\", # corporate franv tax refund\n\n     fund == \"0278\" & sequence == \"02\" ~ \"02\",\n    object==\"9921\" ~ \"21\",                # inheritance tax and estate tax refund appropriation\n    object==\"9923\" ~ \"09\",                # motor fuel tax refunds\n    obj_seq_type == \"99250055\" ~ \"06\",    # sales tax refund\n    fund==\"0378\" & object==\"9925\" ~ \"24\", # insurance privilege tax refund\n   (fund==\"0001\" & object==\"9925\") | (object==\"9925\" & fund == \"0384\" & fy == 2023) ~ \"35\", # all other taxes\n   # fund==\"0001\" & object==\"9925\" ~ \"35\", # all other taxes\n       fund %in% c(\"0946\", \"0912\", \"0671\")  ~ \"35\", # cannabis, aviation, rental purchase tax refund\n    T ~ \"CHECK\"))                       # if none of the items above apply to the observations, then code them as CHECK \n\n    \nexp_temp &lt;- left_join(exp_temp, tax_refund_long) %&gt;%\n  mutate(refund = ifelse(is.na(refund),\"not refund\", as.character(refund)))\n\ntax_refund &lt;- tax_refund_long %&gt;% \n  group_by(refund, fy)%&gt;%\n  summarize(refund_amount = sum(expenditure, na.rm = TRUE)) %&gt;%\n  pivot_wider(names_from = refund, values_from = refund_amount, names_prefix = \"ref_\") %&gt;%\n  mutate_all(~replace_na(.,0)) %&gt;%\n  arrange(fy)\n\ntax_refund %&gt;%\n  pivot_longer(c(ref_06:ref_35, ref_FY23_Rebates), names_to = \"Refund Type\", values_to = \"Amount\") %&gt;%\n  ungroup() |&gt;\n  ggplot()+\n  geom_line(aes(x=fy, y=Amount, group = `Refund Type`, color = `Refund Type`))+\n    scale_y_billions() +\n  labs(title = \"Refund Types\") +\n  labs(title = \"Tax refunds\",\n       caption = \"Rev_type codes: 02=income taxes, 03=corporate income taxes, 06=sales tax, 09=motor fuel tax,\n       24=insurance taxes and fees, 35 = all other tax refunds.\",\n       y=\"Dollars\", x = element_blank()\n       ) \n\n\n\n\n\nFigure 2.1: Tax Refunds\n\n\n\n\n\n\n\n\n\n\nCode\ntax_refund_long &lt;- exp_temp %&gt;%           # fund != \"0401\" # removes State Trust Funds\n  filter(fund != \"0401\" &\n           (object == \"9900\" | object==\"9910\"|object==\"9921\"|object==\"9923\"|object==\"9925\")) %&gt;%\n  # keeps these objects which represent revenue, insurance, treasurer,and financial and professional reg tax refunds\n  mutate(refund = case_when(\n    object == \"9900\" & fund == \"0278\" ~ \"FY23_Rebates\",\n    fund==\"0278\" & sequence == \"00\" ~ \"02\", # for income tax refund\n    fund==\"0278\" & sequence == \"01\" ~ \"03\", # tax administration and enforcement and tax operations become corporate income tax refund\n        fund==\"0380\" ~ \"03\", # corporate franv tax refund\n\n     fund == \"0278\" & sequence == \"02\" ~ \"02\",\n    object==\"9921\" ~ \"21\",                # inheritance tax and estate tax refund appropriation\n    object==\"9923\" ~ \"09\",                # motor fuel tax refunds\n    obj_seq_type == \"99250055\" ~ \"06\",    # sales tax refund\n    fund==\"0378\" & object==\"9925\" ~ \"24\", # insurance privilege tax refund\n   (fund==\"0001\" & object==\"9925\") | (object==\"9925\" & fund == \"0384\" & fy == 2023) ~ \"35\", # all other taxes\n   # fund==\"0001\" & object==\"9925\" ~ \"35\", # all other taxes\n       fund %in% c(\"0946\", \"0912\", \"0671\")  ~ \"35\", # cannabis, aviation, rental purchase tax refund\n    T ~ \"CHECK\"))                       # if none of the items above apply to the observations, then code them as CHECK \n\n    \nexp_temp &lt;- left_join(exp_temp, tax_refund_long) %&gt;%\n  mutate(refund = ifelse(is.na(refund),\"not refund\", as.character(refund)))\n\ntax_refund &lt;- tax_refund_long %&gt;% \n  group_by(refund, fy)%&gt;%\n  summarize(refund_amount = sum(expenditure, na.rm = TRUE)) %&gt;%\n  pivot_wider(names_from = refund, values_from = refund_amount, names_prefix = \"ref_\") %&gt;%\n  mutate_all(~replace_na(.,0)) %&gt;%\n  arrange(fy)\n \ntax_refund %&gt;%\n  pivot_longer(c(ref_06:ref_35), names_to = \"Refund Type\", values_to = \"Amount\") %&gt;%\n  ggplot()+\n  theme_classic()+\n  geom_line(aes(x=fy,y=Amount, group = `Refund Type`, color = `Refund Type`))+\n  labs(title = \"Refund Types\") +\n  labs(title = \"Tax refunds without FY23 Abatements\",\n       caption = \"Rev_type codes: 02=income taxes, 03=corporate income taxes, 06=sales tax, 09=motor fuel tax,\n       24=insurance taxes and fees, 35 = all other tax refunds.\",\n       ) +\n  scale_y_billions()\n\n\n\n\n\nFigure 2.2: Tax Refunds without FY23 Abatements\n\n\n\n\n\n\n\n\n\nCheck tax_refund_long in general. What is actually excluded automaticlly from gap calculation?\n\n\n\nCode\ntax_refund_long |&gt; \n  summarize(expenditure = sum(expenditure, na.rm=TRUE), .by = c(fy, in_ff) ) |&gt;\n  ggplot() + \n  geom_line(aes(x=fy, y = expenditure, group = factor(in_ff), color = factor(in_ff)))+\n  labs(title = \"Excluded Refund Expenditures\", y = \"Dollars\", x = element_blank())\n\n\n\n\n\nFigure 2.3: Based on current fund coding in the fund_ab_in.xlsx file, most refund dollars are already being excluded by having in_ff = 0. Funds that have in_ff = 0 are excluded from revenue and expenditure sums when calculating the Fiscal Gap.\n\n\n\n\n\n\n\n\n\n\nCode\ntax_refund_long_rev &lt;- rev_temp %&gt;%          \n  mutate(refund = case_when(\n    fund == \"0121\" ~ \"35\", # Estate tax refund\n    fund==\"0278\" ~ \"02\", # for income tax refunds (individual and corporate)\n    fund==\"0380\" ~ \"03\", # corporate franchise tax refund\n    fund==\"0378\" ~ \"24\", # insurance privilege tax refund\n    fund %in% c(\"0946\", \"0912\", \"0671\")  ~ \"35\", # cannabis, aviation, rental purchase tax refund\n    T ~ \"CHECK\")) |&gt;                      # if none of the items above apply to the observations, then code them as CHECK \n  filter(refund != \"CHECK\")\n\n    \n\n\ntax_refund_rev &lt;- tax_refund_long_rev %&gt;% \n  group_by(refund, fy)%&gt;%\n  summarize(allocated_for_refunds = sum(receipts, na.rm = TRUE)/1000000) %&gt;%\n  pivot_wider(names_from = refund, values_from = allocated_for_refunds, names_prefix = \"ref_\") %&gt;%\n  mutate_all(~replace_na(.,0)) %&gt;%\n  arrange(fy)\n# \ntax_refund_rev%&gt;%\n  pivot_longer(c(ref_02:ref_35), names_to = \"Refund Type\", values_to = \"Amount\") %&gt;%\n  ggplot()+\n  geom_line(aes(x=fy,y=Amount, group = `Refund Type`, color = `Refund Type`))+\n  labs(title = \"Refund Types\") +\n  labs(title = \"Revenue Allocated to Tax Refund Funds \",\n       caption = \"Rev_type codes: 02=income taxes, 03=corporate income taxes, 06=sales tax, 09=motor fuel tax,\n       24=insurance taxes and fees, 35 = all other tax refunds.\",\n       y = \"Millions of $\", x = element_blank()) + \n    scale_x_continuous(expand = c(0,0), limits = c(1998, current_year+.5), breaks = c(1998, 2005, 2010, 2015, 2020, current_year))\n\n\n\n\n\nFigure 2.4: Tax Refunds from Revenues. Includes only funds designated as Refund funds in fund descriptions.\n\n\n\n\n\n\n\n\nAbatements were a specific policy choice to do and different than normal refunds. Therefore, abatements were included in the fiscal gap calculation. This is not even a concern during most years. Only was an issue in 2023 when $1 billion abatement expenditure occured (as of writing).\n\n\nCode\n# manually adds the abatements as expenditure item and keeps on expenditure side.\n# otherwise ignored since it is in fund 0278, which is coded as in_ff=0\n# all other income tax refunds are excluded from fiscal gap calculations\n\nexp_temp &lt;- exp_temp %&gt;%\n  mutate(in_ff = ifelse(object == 9900 & fund == \"0278\", 1, in_ff))\n\n\n\n\n2.1.2 Pension Expenditures\nAn Explanation of a Methodological Change in How We Categorize Some Pension Spending\nIn previous reports, a expenditure category was created to represent all Pension spending. It was created by removing pension expenditures out of the agencies that that had the expenses in order to highlight the amount that was spent on pensions.\nAs of the FY2024 report, pension expenditures will remain in the agency that has the pension expenses to better represent the total cost of providing a service to the public.\nHowever, we thought that readers also might be interested in total pension spending during current and past years. We have added a separate table showing this information but emphasize that pension spending is already incorporated in other spending categories and should not be added to the total shown in Table 1 of the report.\nNew POB bond in 2019: Accelerated Bond Fund paid benefits in advance as lump sum\nState pension contributions for TRS and SURS are largely captured with object=4431. (State payments into pension fund). State payments to the following pension systems:\n\nTeachers Retirement System (TRS) Agency 493 –&gt; K-12 Education (Group = 959)\nState Employee Retirement System (SERS) Agency 589 –&gt; SERS Agency 589 - Note: Object 4431 does not have SERS expenditures in it. Those are only in object 116X objects\n\nState University Retirement System (SURS) Agency 693 –&gt; University Education (Group = 960)\n\nJudges Retirement System (JRS) Agency 275 –&gt; Judicial (Group = 920)\n\nGeneral Assembly Retirement System (GARS) –&gt; Legislative (Group 910)\n\nThere are also “Other Post-Employment Benefits” (OPEBs). Expenditure object 4430 is for retirement benefits.\nWhile it is good to know the overall cost of pensions for the state, if you want to know the true cost of providing services, pension and other benefit costs should be included in the department that is paying employees to provide those services.\n\nChange in pension coding in chunk below:\n\n\n\nCode\nexp_temp &lt;-  exp_temp %&gt;% \n  arrange(fund) %&gt;%\n  mutate(pension = case_when( \n    \n    ## Commented out line below:\n    # (object==\"4431\") ~ 1, # 4431 = easy to find pension payments INTO fund\n    \n\n    \n    (object==\"1298\" &  # Purchase of Investments, Normally excluded\n       (fy==2010 | fy==2011) & \n       (fund==\"0477\" | fund==\"0479\" | fund==\"0481\")) ~ 3, #judges retirement OUT of fund\n    # state borrowed money from pension funds to pay for core services during 2010 and 2011. \n    # used to fill budget gap and push problems to the future. \n    \n    fund == \"0319\" ~ 4, # pension stabilization fund\n    TRUE ~ 0) )\n\n\n\n\nCode\n# special accounting of pension obligation bond (POB)-funded contributions to JRS, SERS, GARS, TRS \n\nexp_temp &lt;- exp_temp %&gt;% \n  # change object for 2010 and 2011, retirement expenditures were bond proceeds and would have been excluded\n  mutate(object = ifelse((pension &gt; 0 & in_ff == \"0\"), \"4431\", object)) %&gt;% \n  # changes weird teacher & judge retirement system  pensions object to normal pension object 4431\n  mutate(pension =  ifelse(pension &gt; 0 & in_ff == \"0\", 6, pension)) %&gt;% # coded as 6 if it was supposed to be excluded. \n  mutate(in_ff = ifelse(pension &gt; 0, \"1\", in_ff))\n\n\n\n# all other pensions objects  codes get agency code 901 for State Pension Contributions\nexp_temp &lt;- exp_temp %&gt;% \n  mutate(agency = ifelse(pension &gt; 0, \"901\", as.character(agency)),\n         agency_name = ifelse(agency == \"901\", \"State Pension Contributions\", as.character(agency_name)))\n\n\nCan also be thought of past commitments vs current contributions. Cost of past commitments in the form of Pension benefits paid out,\nCurrent Employees vs Retired Employees\nCurrent Employees: - Group Insurance Benefits\nRetired Employees: - Deferred Compensation\n- Medicare Retirees and Survivors of State of Illinois Employees Group Insurance Program (SEGIP)\n- Part of Medicare\n\n\nCode\nexp_temp|&gt;\n  filter(fy==2024) |&gt;\n  filter((appr_org==\"01\" | appr_org == \"65\" | appr_org==\"88\") & (object==\"4900\" | object==\"4400\") )|&gt; \n  group_by(agency, agency_name) |&gt; # separates CHIP from health and human services and saves it as Medicaid\n  summarize(expenditure = sum(expenditure))\n\n\n\n  \n\n\n\nDrop all cash transfers between funds, statutory transfers, and purchases of investments from expenditure data.\n\n\nCode\ntransfers_drop &lt;- exp_temp %&gt;% filter(\n  agency == \"799\" | # statutory transfers\n           object == \"1993\" |  # interfund cash transfers\n           object == \"1298\") # purchase of investments\ntransfers_drop # items being dropped, \n\n\n\n  \n\n\n\nCode\n# always check to make sure you aren't accidentally dropping something of interest.\n\nexp_temp &lt;- anti_join(exp_temp, transfers_drop)\n\n\n\n\n2.1.3 State employee healthcare costs\n\nRe-commented this out: Commented out line of code that seperates healthcare costs. This should keep healthcare costs in the agency, similar to the change that was made for pensions.\n\nagency==\"507\"|  agency==\"442\" | agency==\"445\" | agency==\"452\" |agency==\"458\" | agency==\"497\" ~ \"948\", # other departments\nIt looks like healthcare costs shift to “Other Departments” which includes :\n\nGOMB (507)\n\nHuman Rights (442)\n\nIllinois Power Agency (445)\n\nLabor (452)\n\nState Lottery (458)\n\nVeteran’s Affairs (497)\n\n\n\nCode\n#if observation is a group insurance contribution, then the expenditure amount is set to $0 (essentially dropped from analysis)\n\n# pretend eehc is named group_insurance_contribution or something like that\n# eehc coded as zero implies that it is group insurance\n# if eehc=0, then expenditures are coded as zero for group insurance to avoid double counting costs\n\n\nexp_temp &lt;- exp_temp %&gt;% \n  mutate(eehc = ifelse(\n    # group insurance contributions for 1998-2005 and 2013-present\n   fund == \"0001\" & (object == \"1180\" | object ==\"1900\") & agency == \"416\" & appr_org==\"20\", 0, 1) )%&gt;% \n  \n  mutate(eehc = ifelse(\n    # group insurance contributions for 2006-2012\n    fund == \"0001\" & object == \"1180\" & agency == \"478\" \n    & appr_org==\"80\", 0, eehc) )%&gt;%\n    \n   # group insurance contributions from road fund\n  # coded with 1900 for some reason??\n    mutate(eehc = ifelse(\n      fund == \"0011\" & object == \"1900\" & \n        agency == \"416\" & appr_org==\"20\", 0, eehc) ) %&gt;%\n  \n  mutate(expenditure = ifelse(eehc==\"0\", 0, expenditure)) %&gt;%\n\n  mutate(agency = case_when(\n    ## turns specific items into State Employee Healthcare (agency=904)\n      fund==\"0907\" & (agency==\"416\" & appr_org==\"20\") ~ \"904\",   # central management Bureau of benefits using health insurance reserve\n      fund==\"0907\" & (agency==\"478\" & appr_org==\"80\") ~ \"904\",   # agency = 478: healthcare & family services using health insurance reserve - stopped using this in 2012\n       TRUE ~ as.character(agency))) %&gt;%\n  \n  mutate(agency_name = ifelse(\n    agency == \"904\", \"STATE EMPLOYEE HEALTHCARE\", as.character(agency_name)),\n         in_ff = ifelse(agency == \"904\", 1, in_ff),\n         group = ifelse(agency == \"904\", \"904\", as.character(agency)))  \n# creates group variable\n\n# Default group = agency number\n\nhealthcare_costs &lt;- exp_temp %&gt;% filter(group == \"904\")\n\n\n\n\nCode\nexp_temp &lt;- exp_temp %&gt;% mutate(\n  agency = case_when(fund==\"0515\" & object==\"4470\" & type==\"08\" ~ \"971\", # income tax to local governments\n                     fund==\"0515\" & object==\"4491\" & type==\"08\" & sequence==\"00\" ~ \"971\", # object is shared revenue payments\n                     fund==\"0802\" & object==\"4491\" ~ \"972\", #pprt transfer\n                     fund==\"0515\" & object==\"4491\" & type==\"08\" & sequence==\"01\" ~ \"976\", #gst to local\n                     fund==\"0627\" & object==\"4472\"~ \"976\" , # public transportation fund but no observations exist\n                     fund==\"0648\" & object==\"4472\" ~ \"976\", # downstate public transportation, but doesn't exist\n                     fund==\"0515\" & object==\"4470\" & type==\"00\" ~ \"976\", # object 4470 is grants to local governments\n                    object==\"4491\" & (fund==\"0188\"|fund==\"0189\") ~ \"976\",\n                     fund==\"0187\" & object==\"4470\" ~ \"976\",\n                     fund==\"0186\" & object==\"4470\" ~ \"976\",\n                    object==\"4491\" & (fund==\"0413\"|fund==\"0414\"|fund==\"0415\")  ~ \"975\", #mft to local\n                  fund == \"0952\"~ \"975\", # Added Sept 29 2022 AWM. Transportation Renewal MFT\n                    TRUE ~ as.character(agency)),\n  \n  agency_name = case_when(agency == \"971\"~ \"INCOME TAX 1/10 TO LOCAL\",\n                          agency == \"972\" ~ \"PPRT TRANSFER TO LOCAL\",\n                          agency == \"975\" ~ \"MFT TO LOCAL\",\n                          agency == \"976\" ~ \"GST TO LOCAL\",\n                          TRUE~as.character(agency_name)),\n  group = ifelse(agency&gt;\"970\" & agency &lt; \"977\", as.character(agency), as.character(group)))\n\n\n\n\n2.1.4 Local Transfers\n\n\nCode\ntransfers_long &lt;- exp_temp %&gt;% \n  filter((group == \"971\" |group == \"972\" | group == \"975\" | group == \"976\")) \n#  fund == \"0325\")\n\ntransfers_long %&gt;% \n  group_by(agency_name, group, fy) %&gt;% \n  summarize(expenditure = sum(expenditure, na.rm=TRUE) )%&gt;% \n  ggplot() + \n  geom_line(aes(x=fy, y = expenditure, color=agency_name)) + \n  alea_theme() + \n  scale_x_continuous(expand = c(0,0), limits = c(1998, current_year+.5), breaks = c(1998, 2005, 2010, 2015, 2020, current_year)) +\n  \n  labs(title = \"Transfers to Local Governments\", caption = \"Data Source: Illinois Office of the Comptroller\")\n\n\n\n\n\nFigure 2.5: Drop Transfers from State to Local Governments\n\n\n\n\n\n\n\n\n\n\nCode\ntransfers_long &lt;- exp_temp %&gt;% \n  filter(group == \"971\" |group == \"972\" | group == \"975\" | group == \"976\")\n\n\ntransfers &lt;- transfers_long %&gt;%\n  group_by(fy, group ) %&gt;%\n  summarize(sum_expenditure = sum(expenditure)/1000000) %&gt;%\n  pivot_wider(names_from = \"group\", values_from = \"sum_expenditure\", names_prefix = \"exp_\" )\n\nexp_temp &lt;- anti_join(exp_temp, transfers_long)\n\n\ndropped_inff_0 &lt;- exp_temp %&gt;% filter(in_ff == 0)\n\nexp_temp &lt;- exp_temp %&gt;% filter(in_ff == 1) # drops in_ff = 0 funds AFTER dealing with net-revenue above\n\n\n\n\n2.1.5 Debt\n\n\nCode\ndebt_drop &lt;- exp_temp %&gt;% \n  filter(object == \"8841\" |  object == \"8811\")  \n# escrow  OR  principle\n\n#debt_drop %&gt;% group_by(fy) %&gt;% summarize(sum = sum(expenditure)) %&gt;% arrange(-fy)\n\n\ndebt_keep &lt;- exp_temp %&gt;% \n  filter(fund != \"0455\" & (object == \"8813\" | object == \"8800\" )) \n# examine the debt costs we want to include\n\n#debt_keep %&gt;% group_by(fy) %&gt;% summarize(sum = sum(expenditure)) %&gt;% arrange(-fy) \n\n\nexp_temp &lt;- anti_join(exp_temp, debt_drop) \nexp_temp &lt;- anti_join(exp_temp, debt_keep)\n\ndebt_keep &lt;- debt_keep %&gt;%\n  mutate(\n    agency = ifelse(fund != \"0455\" & (object == \"8813\" | object == \"8800\"), \"903\", as.character(agency)),\n    group = ifelse(fund != \"0455\" & (object == \"8813\" | object == \"8800\"), \"903\", as.character(group)),\n    in_ff = ifelse(group == \"903\", 1, as.character(in_ff)))\n\ndebt_keep_yearly &lt;- debt_keep %&gt;% \n  group_by(fy, group) %&gt;% \n  summarize(debt_cost = sum(expenditure,na.rm=TRUE)/1000000) %&gt;% \n  select(-group)\n\n\n\n\nCode\ntollway_exp &lt;- exp_temp %&gt;% filter(fund == \"0455\") %&gt;% group_by(fy) %&gt;% summarize(expenditure = sum(expenditure))\n                                                                                                    #tollway_exp %&gt;% ggplot() + geom_line(aes(x=fy, y=expenditure)) + labs(title = \"Fund 0455 from Expenditure: All Tollway Expenditures\", caption = \"Data from IOC Expenditure Files. Fund 0455 is the IL State Tollway\")\n\n\n# all tollway revenues, not just bond proceeds\nalltollway&lt;-rev_temp %&gt;% filter(fund == \"0455\" & source != \"0571\") %&gt;% group_by(fy) %&gt;% summarize(sum = sum(receipts, na.rm = TRUE))\n\n\n# tollway bond proceeds\ntollway_bondproc &lt;- rev_temp %&gt;% filter(fund == \"0455\" & source == \"0571\" ) %&gt;% group_by(fy) %&gt;% summarize(sum = sum(receipts, na.rm = TRUE))\n\n#alltollway %&gt;%  ggplot() + geom_line(aes(x=fy, y=sum)) + labs(title = \"Fund 0455 - All Tollway Revenue\", caption = \"Data from IOC Revenue Files. Fund 0455 is the IL State Tollway Revenue\") \n\n#tollway_bondproc %&gt;% ggplot() + geom_line(aes(x=fy, y=sum)) + labs(title = \"Fund 0455 - Tollway Revenue: Tollway Bond Proceeds\", caption = \"Data from IOC Revenue Files. Fund 0455 is the IL State Tollway Revenue\")\n  \n#ggplot() + geom_line(data=tollway_bondproc, aes(x=fy, y=sum)) + labs(title = \"Fund 0455 - Tollway Revenue: Tollway Bond Proceeds\", caption = \"Data from IOC Revenue Files. Fund 0455 is the IL State Tollway Revenue\")\n\n#tollwaydebt %&gt;% ggplot() + geom_line(aes(x=fy, y=sum)) + labs(title = \"Tollway Debt Service\", caption = \"Debt service includes principal and interest for the Illinois Tollway. Object = 8800 and fund = 0455\")\n\n\n#tollway debt principal and interest\ntollwaydebt &lt;- exp_temp %&gt;%filter(object == \"8800\" & fund == \"0455\") %&gt;% group_by(fy) %&gt;% summarize(sum=sum(expenditure)) \n\n# Tollway agency expenditures = SAME as filtering by fund == 0455\n#tollway&lt;-exp_temp %&gt;% filter(agency == \"557\")\n#exp_temp %&gt;% filter(agency == \"557\") %&gt;% group_by(fy) %&gt;% summarize(sum = sum(expenditure)) %&gt;% arrange(-fy)\n\n# contributions and benefits paid comparison\nggplot()+\n  scale_x_continuous(expand = c(0,0), limits = c(1998, current_year+.5), breaks = c(1998, 2005, 2010, 2015, 2020, current_year)) +\n    geom_line(data=tollway_bondproc, aes(x=fy, y=sum, color='Bond Proceeds')) +\n  geom_line(data= tollwaydebt, aes(x=fy, y = sum, color = 'Debt Service'))+ \n  geom_line(data= tollway_exp, aes(x=fy, y = expenditure, color = 'Tollway Expenditures'))+ \n  geom_line(data= alltollway, aes(x=fy, y = sum, color = \"Tollway Revenue\"))+ \n  scale_color_manual(values = c(\n    'Bond Proceeds' = 'darkblue',\n    'Debt Service' = 'red',\n    'Tollway Expenditures' = 'orange',\n    'Tollway Revenue' = 'light green')) +\n  labs(title=\"Tollway bond procreeds, debt service, revenue, and expenditures.\", \n       caption = \"Tollway revenue + bond proceeds should be roughly equal to tollway expenditures + debt service.\", \n       y = \"Dollars\")\n\n\n\n\n\n\n\n\n\n\n\n2.1.6 Add Other Fiscal Future group codes\n\nCommented out line that creates Other departments from a few agencies. Keeping them seperate to see where healthcare costs go.\n\nagency==\"507\"|  agency==\"442\" | agency==\"445\" | agency==\"452\" |agency==\"458\" | agency==\"497\" ~ \"948\", # other departments\n\n\nCode\nexp_temp &lt;- exp_temp %&gt;%\n  #mutate(agency = as.numeric(agency) ) %&gt;%\n  # arrange(agency)%&gt;%\n  mutate(\n    group = case_when(\n      agency&gt;\"100\"& agency&lt;\"200\" ~ \"910\", # legislative\n      \n      agency == \"528\"  | (agency&gt;\"200\" & agency&lt;\"300\") ~ \"920\", # judicial \n      \n      ######################################################\n      # Not used if we are not separating pension costs!!\n      # pension &gt; 0  ~ \"901\", # pensions\n      \n      ## New CODE: April 23rd, 2025:\n      agency == \"593\" ~ \"959\", #  TRS becomes part of K-12 costs\n      agency == \"594\" ~ \"959\",   # TRS\n      agency == \"589\" ~ \"948\", # SERS becomes part of \"Other Agencies\"\n      agency == \"693\" ~ \"960\", # SURS becomes part of group 960\n      agency == \"275\" ~ \"920\",  # JRS becomes part of group 920\n      agency == \"131\" ~  \"910\", # GARS becomes part of Group 910\n      ######################################################\n      \n      (agency&gt;\"309\" & agency&lt;\"400\") ~ \"930\",    # elected officers: Governor, lt gov, attorney general, sec. of state, comptroller, treasurer\n      \n      agency == \"586\" ~ \"959\", # create new K-12 group\n\n      agency==\"402\" | agency==\"418\" | agency==\"478\" | agency==\"444\" | agency==\"482\" ~ as.character(agency), # aging, CFS, HFS, human services, public health\n      T ~ as.character(group))\n    ) %&gt;%      \n\n  \n  mutate(group = case_when(\n    agency==\"478\" & (appr_org==\"01\" | appr_org == \"65\" | appr_org==\"88\") & (object==\"4900\" | object==\"4400\") ~ \"945\", # separates CHIP from health and human services and saves it as Medicaid\n    \n    agency == \"586\" & fund == \"0355\" ~ \"945\",  # 586 (Board of Edu) has special education which is part of medicaid\n    \n    # OLD CODE: agency == \"586\" & appr_org == \"18\" ~ \"945\", # Spec. Edu Medicaid Matching\n    \n    agency==\"425\" | agency==\"466\" | agency==\"546\" | agency==\"569\" | agency==\"578\" | agency==\"583\" | agency==\"591\" | agency==\"592\" | agency==\"493\" | agency==\"588\" ~ \"941\", # public safety & Corrections\n    \n    agency==\"420\" | agency==\"494\" |  agency==\"406\" | agency==\"557\" ~ as.character(agency), # econ devt & infra, tollway\n    \n    agency==\"511\" | agency==\"554\" | agency==\"574\" | agency==\"598\" ~ \"946\",  # Capital improvement\n    \n    agency==\"422\" | agency==\"532\" ~ as.character(agency), # environment & nat. resources\n    \n    agency==\"440\" | agency==\"446\" | agency==\"524\" | agency==\"563\"  ~ \"944\", # business regulation\n    \n    agency==\"492\" ~ \"492\", # revenue\n    \n    agency == \"416\" ~ \"416\", # central management services\n    agency==\"448\" & fy &gt; 2016 ~ \"416\", #add DoIT to central management \n    \n    T ~ as.character(group))) %&gt;%\n  \n  \n  mutate(group = case_when(\n    # agency==\"684\" | agency==\"691\"  ~ as.character(agency), # moved under higher education in next line. 11/28/2022 AWM\n    \n    agency==\"692\" | agency == \"693\" | agency==\"695\" | agency == \"684\" |agency == \"691\" | (agency&gt;\"599\" & agency&lt;\"677\") ~ \"960\", # higher education\n    \n    agency==\"427\"  ~ as.character(agency), # employment security\n    \n############################ \n# Leaving these agencies as their own agency number for now. Had been coded to \"Other departments\" Group 948\n# - GOMB (507)  \n# - Human Rights (442)  \n# - Illinois Power Agency (445)  \n# - Labor (452)   \n# - State Lottery (458)   \n# - Veteran's Affairs (497) \n\n       agency==\"507\" | agency==\"442\" | agency==\"445\" | agency==\"452\" |agency==\"458\" | agency==\"497\" ~ as.character(agency), # Were included within \"other departments\"\n    \n  #  agency==\"507\"|  agency==\"442\" | agency==\"445\" | agency==\"452\" |agency==\"458\" | agency==\"497\" ~ \"948\", # other departments\n\n###########################################\n    \n\n# other boards & Commissions\n    agency==\"503\" | agency==\"509\" | agency==\"510\" | agency==\"565\" |agency==\"517\" | agency==\"525\" | agency==\"526\" | agency==\"529\" | agency==\"537\" | agency==\"541\" | agency==\"542\" | agency==\"548\" |  agency==\"555\" | agency==\"558\" | agency==\"559\" | agency==\"562\" | agency==\"564\" | agency==\"568\" | agency==\"579\" | agency==\"580\" | agency==\"587\" | agency==\"590\" | agency==\"527\" | agency==\"585\" | agency==\"567\" | agency==\"571\" | agency==\"575\" | agency==\"540\" | agency==\"576\" | agency==\"564\" | agency==\"534\" | agency==\"520\" | agency==\"506\" | agency == \"533\" ~ \"949\", \n    \n# Other Departments\n  #   Before pensions were included back with the original agency that spent the money, remaining non-pension expenditures from agencies that deal with pensions were included with Other Departments \n  #   agency==\"131\" |\n  #   agency==\"275\" | #JRS\n  #   agency==\"589\" | #SERS\n  #   agency==\"593\"|  # TRS\n  #   agency==\"594\"| # Also TRS\n  #   agency==\"693\"   #SURS\n  #  ~ \"948\",\n    \n    T ~ as.character(group))) %&gt;%\n  \n  mutate(group_name = \n           case_when(\n             group == \"416\" ~ \"Central Management\",\n             group == \"442\" ~ \"Human Rights\",\n             group == \"445\"  ~ \"Illinois Power Agency\",\n             group == \"452\" ~ \"Labor\",\n             group == \"458\" ~ \"State Lottery\",\n             group == \"489\" ~ \"SERS\",\n             group == \"478\" ~ \"Healthcare and Family Services\",\n             group == \"482\" ~ \"Public Health\",\n             group == \"497\" ~ \"Veteran's Affairs\",\n             group == \"507\" ~ \"GOMB\",\n             group == \"901\" ~ \"STATE PENSION CONTRIBUTION\",\n             group == \"903\" ~ \"DEBT SERVICE\",\n             group == \"910\" ~ \"LEGISLATIVE\"  ,\n             group == \"920\" ~ \"JUDICIAL\" ,\n             group == \"930\" ~ \"ELECTED OFFICERS\" , \n             group == \"940\" ~ \"OTHER HEALTH-RELATED\", \n             group == \"941\" ~ \"PUBLIC SAFETY\" ,\n             group == \"942\" ~ \"ECON DEVT & INFRASTRUCTURE\" ,\n             group == \"943\" ~ \"CENTRAL SERVICES\",\n             group == \"944\" ~ \"BUS & PROFESSION REGULATION\" ,\n             group == \"945\" ~ \"MEDICAID\" ,\n             group == \"946\" ~ \"CAPITAL IMPROVEMENT\" , \n             group == \"948\" ~ \"OTHER DEPARTMENTS\" ,\n             group == \"949\" ~ \"OTHER BOARDS & COMMISSIONS\" ,\n             group == \"959\" ~ \"K-12 EDUCATION\" ,\n             group == \"960\" ~ \"UNIVERSITY EDUCATION\" ,\n             group == agency ~ as.character(agency_name),\n             TRUE ~ \"Check name\"),\n         year = fy)\n\nexp_temp %&gt;% filter(group_name == \"Check name\")\n\n\n\n  \n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nAll expenditures recoded but not aggregated: Allows for inspection of individual expenditures within larger categories. This stage of the data is extremely useful for investigating how individual items have been coded before they are aggregated into larger categories.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>FY2025 Report Images and Tables</span>"
    ]
  },
  {
    "objectID": "Everything_changepensions.html#modify-revenue-data",
    "href": "Everything_changepensions.html#modify-revenue-data",
    "title": "2  FY2025 Report Images and Tables",
    "section": "2.2 Modify Revenue data",
    "text": "2.2 Modify Revenue data\n\n\nCode\n# recodes old agency numbers to consistent agency number\nrev_temp &lt;- rev_temp %&gt;% \n  mutate(agency = case_when(\n    (agency==\"438\"| agency==\"475\" |agency == \"505\") ~ \"440\",\n    # financial institution &  professional regulation &\n     # banks and real estate  --&gt; coded as  financial and professional reg\n    agency == \"473\" ~ \"588\", # nuclear safety moved into IEMA\n    (agency ==\"531\" | agency ==\"577\") ~ \"532\", # coded as EPA\n    (agency ==\"556\" | agency == \"538\") ~ \"406\", # coded as agriculture\n    agency == \"560\" ~ \"592\", # IL finance authority (fire trucks and agriculture stuff)to state fire marshal\n    agency == \"570\" & fund == \"0011\" ~ \"494\",   # city of Chicago road fund to transportation\n    TRUE ~ (as.character(agency)))) \n\n\n\n2.2.0.1 Federal Transfers\n\n\nCode\n#rev_temp &lt;- rev_temp %&gt;% filter(in_ff==1)\n\nrev_temp &lt;- rev_temp %&gt;% \n  mutate(\n    rev_type = ifelse(rev_type==\"57\" & agency==\"478\" & (source==\"0618\"|source==\"2364\"|source==\"0660\"|source==\"1552\"| source==\"2306\"| source==\"2076\"|source==\"0676\"|source==\"0692\"), \"58\", rev_type),\n    rev_type_name = ifelse(rev_type==\"58\", \"Federal Medicaid Reimbursements\", rev_type_name),\n    rev_type = ifelse(rev_type==\"57\" & agency==\"494\", \"59\", rev_type),\n    rev_type_name = ifelse(rev_type==\"59\", \"Federal Transportation\", rev_type_name),\n    rev_type_name = ifelse(rev_type==\"57\", \"Federal - Other\", rev_type_name),\n    rev_type = ifelse(rev_type==\"6\", \"06\", rev_type),\n    rev_type = ifelse(rev_type==\"9\", \"09\", rev_type)) \n\nrev_temp %&gt;% \n  filter(rev_type == \"58\" | rev_type == \"59\" | rev_type == \"57\") %&gt;% \n  group_by(fy, rev_type, rev_type_name) %&gt;% \n  summarise(receipts = sum(receipts, na.rm = TRUE)/1000000) %&gt;% \n  ggplot() +\n  geom_line(aes(x=fy, y=receipts,color=rev_type_name)) +\n  scale_y_continuous(labels = comma)+\n  labs(title = \"Federal to State Transfers\", \n       y = \"Millions of Dollars\", x = \"\") + \n  theme(legend.position = \"bottom\", legend.title = element_blank()  )\n\n\n\n\n\nFigure 2.6\n\n\n\n\n\n\n\n\n\n\nCode\nrev_temp &lt;- rev_temp %&gt;% mutate(covid_dollars = ifelse(source_name_AWM == \"FEDERAL STIMULUS PACKAGE\",1,0))\n\nrev_temp %&gt;% filter(source_name_AWM == \"FEDERAL STIMULUS PACKAGE\") %&gt;%\n  group_by(fy) %&gt;% summarize(Received = sum(receipts))\n\n\n\n  \n\n\n\n\n\n2.2.1 Medicaid Revenue vs Medicaid Expenditures\n\n\nCode\nmedicaid_cost &lt;- exp_temp %&gt;% \n  filter(agency==\"478\" & (appr_org==\"01\" | appr_org == \"65\" | appr_org==\"88\") & (object==\"4900\" | object==\"4400\")) %&gt;% \n  group_by(fy) %&gt;% \n  summarize(sum=sum(expenditure))\n\nmed_reimburse &lt;- rev_temp %&gt;% \n  filter(rev_type==\"57\" & agency==\"478\" & (source==\"0618\"|source==\"2364\"|source==\"0660\"|source==\"1552\"| source==\"2306\"| source==\"2076\"|source==\"0676\"|source==\"0692\")) %&gt;% \n  group_by(fy) %&gt;% \n  summarize(sum=sum(receipts))\n\n\n\nggplot()+\n  geom_line(data=medicaid_cost, aes(x=fy, y=sum, color = \"Expenditures\")) + \n  geom_line(data=med_reimburse, aes(x=fy, y = sum, color = \"Reimbursements\")) + \n  scale_x_continuous(n.breaks = 6) +\n  labs(title = \"Medicaid reimbursements and Medicaid expenditures\", \n       caption = \"Medicaid expenditures include funds provided to medical providers.\", \n       color = element_blank()\n       )\n\n\n\n\n\n\n\n\n\n\n\n2.2.2 Health Insurance Premiums from Employees\nInsurance premiums for employees is coded below but it is NOT used in the fiscal futures model. Employee and employer premiums are considered rev_51 and dropped from analysis in later step.\n\n0120 = ins prem-option life\n0120 = ins prem-optional life/univ\n0347 = optional health - HMO\n0348 = optional health - dental\n0349 = optional health - univ/local SI\n0350 = optional health - univ/local\n0351 = optional health - retirement\n0352 = optional health - retirement SI\n0353 = optional health - retire/dental\n0354 = optional health - retirement hmo\n2199-2209 = various HMOs, dental, health plans from Health Insurance Reserve (fund)\n\n\n\nCode\n#collect optional insurance premiums to fund 0907 for use in eehc expenditure  \nrev_temp &lt;- rev_temp %&gt;% \n  mutate(\n    employee_premiums = ifelse(fund==\"0907\" & (source==\"0120\"| source==\"0121\"| (source&gt;\"0345\" & source&lt;\"0357\")|(source&gt;\"2199\" & source&lt;\"2209\")), 1, 0),\n    \n    # adds more rev_type codes\n    rev_type = case_when(\n      fund ==\"0427\" ~ \"12\", # pub utility tax\n      fund == \"0742\" | fund == \"0473\" ~ \"24\", # insurance and fees\n      fund == \"0976\" ~ \"36\",# receipts from rev producing\n      fund == \"0392\" |fund == \"0723\" ~ \"39\", # licenses and fees\n      fund == \"0656\" ~ \"78\", #all other rev sources\n      TRUE ~ as.character(rev_type)))\n# if not mentioned, then rev_type as it was\n\n\n\n\nCode\n# # optional insurance premiums = employee insurance premiums\n\n# emp_premium &lt;- rev_temp %&gt;%\n#   group_by(fy, employee_premiums) %&gt;%\n#   summarize(employee_premiums_sum = sum(receipts)/1000000) %&gt;%\n#   filter(employee_premiums == 1) %&gt;%\n#   rename(year = fy) %&gt;% \n#   select(-employee_premiums)\n\nemp_premium_long &lt;- rev_temp %&gt;%  filter(employee_premiums == 1)\nemp_premium_long\n\n\n\n  \n\n\n\nCode\n# drops employee premiums from revenue\n# rev_temp &lt;- rev_temp %&gt;% filter(employee_premiums != 1)\n# should be dropped in next step since rev_type = 51\n\n\nNote: In FY21, employee premiums were subtracted from state healthcare costs on the expenditure side to calculate a “Net Healthcare Cost” but that methodology has been discontinued. Totals were practically unchanged: revenue from employee premiums is also very small.\n\n\n2.2.3 Transfers in and Out:\nFunds that hold and disperse local taxes or fees are dropped from the analysis. Then other excluded revenue types are also dropped.\nDrops Blank, Student Fees, Retirement contributions, proceeds/investments, bond issue proceeds, interagency receipts, cook IGT, Prior year refunds:\n\nClean up code and annotations in chunk below:\n\n\n\nCode\nrev_temp &lt;- rev_temp %&gt;% \n  filter(in_ff == 1) %&gt;% \n  mutate(local = ifelse(is.na(local), 0, local)) %&gt;% # drops all revenue observations that were coded as \"local == 1\"\n  filter(local != 1)\n\n# 1175 doesnt exist?\nin_from_out &lt;- c(\"0847\", \"0867\", \"1175\", \"1176\", \"1177\", \"1178\", \"1181\", \"1182\", \"1582\", \"1592\", \"1745\", \"1982\", \"2174\", \"2264\")\n\n# what does this actually include:\n# all are items with rev_type = 75 originally. \nin_out_df &lt;- rev_temp %&gt;%\n  mutate(infromout = ifelse(source %in% in_from_out, 1, 0)) %&gt;%\n  filter(infromout == 1)\n\nrev_temp &lt;- rev_temp %&gt;% \n   mutate(rev_type_new = ifelse(source %in% in_from_out, \"76\", rev_type))\n# if source contains any of the codes in in_from_out, code them as 76 (all other rev).\n# I end up excluding rev_76 in later steps\n\n\n\n\nCode\n# revenue types to drop\ndrop_type &lt;- c(\"32\", \"45\", \"51\", \n               \"66\", \"72\", \"75\", \"76\", \"79\", \"98\", \"99\")\n\n# drops Blank, Student Fees, Retirement contributions, proceeds/investments,\n# bond issue proceeds, interagency receipts, cook IGT, Prior year refunds.\n\n\nrev_temp &lt;- rev_temp %&gt;% filter(!rev_type_new %in% drop_type)\n# keep observations that do not have a revenue type mentioned in drop_type\n\ntable(rev_temp$rev_type_new)\n\n\n\n   02    03    06    09    12    15    18    21    24    27    30    31    33 \n  209   148   901   148   629   291    51  1423   517    85   677   140   160 \n   35    36    39    42    48    54    57    58    59    60    63    78 \n  751  5668 10376  3313    34  1351  7124   698   247   109  5797 12649 \n\n\nCode\nrev_temp %&gt;% \n  group_by(fy, rev_type_new) %&gt;% \n  summarize(total_reciepts = sum(receipts)/1000000) %&gt;%\n  pivot_wider(names_from = rev_type_new, values_from = total_reciepts, names_prefix = \"rev_\") \n\n\n\n  \n\n\n\nCode\nrm(rev_1998_2022)\nrm(exp_1998_2022)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>FY2025 Report Images and Tables</span>"
    ]
  },
  {
    "objectID": "Everything_changepensions.html#pivoting-and-merging",
    "href": "Everything_changepensions.html#pivoting-and-merging",
    "title": "2  FY2025 Report Images and Tables",
    "section": "2.3 Pivoting and Merging",
    "text": "2.3 Pivoting and Merging\n\n2.3.1 Revenues\n\n\n\nCode\nff_rev &lt;- rev_temp %&gt;% \n  group_by(rev_type_new, fy) %&gt;% \n  summarize(sum_receipts = sum(receipts, na.rm=TRUE)/1000000 ) %&gt;%\n  pivot_wider(names_from = \"rev_type_new\", values_from = \"sum_receipts\", names_prefix = \"rev_\")\n\n \nff_rev &lt;- mutate_all(ff_rev, ~replace_na(.,0))\n\n# OLD way of doing refunds ##\n# ff_rev &lt;- ff_rev %&gt;%\n#   mutate(rev_02 = rev_02 - ref_02,\n#          rev_03 = rev_03 - ref_03,\n#          rev_06 = rev_06 - ref_06,\n#          rev_09 = rev_09 - ref_09,\n#          rev_21 = rev_21 - ref_21,\n#          rev_24 = rev_24 - ref_24,\n#          rev_35 = rev_35 - ref_35\n# \n#       #   rev_78new = rev_78 #+ pension_amt #+ eehc\n#          ) %&gt;% \n#   select(-c(ref_02:ref_35, rev_99, rev_NA, rev_76\n#             #, ref_CHECK#, pension_amt , rev_76,\n#           #  , eehc\n#             ))\n# \n# ff_rev\n\n\n\n#noproblem &lt;- c(0)  # if ref_CHECK = $0, then there is no problem. :) \n# \n# if((sum(ff_rev$ref_CHECK) == 0 )){\n# \n# ff_rev &lt;- ff_rev %&gt;%\n#   \n#   mutate(rev_02 = rev_02 - ref_02,\n#          rev_03 = rev_03 - ref_03,\n#          rev_06 = rev_06 - ref_06,\n#          rev_09 = rev_09 - ref_09,\n#          rev_21 = rev_21 - ref_21,\n#          rev_24 = rev_24 - ref_24,\n#          rev_35 = rev_35 - ref_35\n#          ) %&gt;% \n#   select(-c(ref_02:ref_35, rev_99, rev_76, ref_CHECK )) \n# }else{\"You have a problem! Check what revenue items did not have rev codes (causing it to be coded as rev_NA) or the check if there were refunds that were not assigned revenue codes (tax_refunds_long objects)\"}\n\nff_rev %&gt;%  mutate_all(., ~round(.,digits=0))\n\n\n\n\nTable 2.1: Pivoted Revenue Table ($ Millions) - Intermediate Step. Not actually used for anything other than to have output in same format as old STATA output to make it easily comparable.\n\n\n\n\n  \n\n\n\n\n\n\n\n\n2.3.2 Expenditures\nCreate exp_970 for all local government transfers (exp_971 + exp_972 + exp_975 + exp_976).\n\n\nCode\nff_exp &lt;- exp_temp %&gt;% \n  group_by(fy, group) %&gt;% \n  summarize(sum_expenditures = sum(expenditure, na.rm=TRUE)/1000000 ) %&gt;%\n  pivot_wider(names_from = \"group\", values_from = \"sum_expenditures\", names_prefix = \"exp_\")%&gt;%\n  \n    left_join(debt_keep_yearly) %&gt;%\n  rename(exp_903 = debt_cost) %&gt;%\n\n #  join local transfers and create exp_970\n  left_join(transfers) %&gt;%\n  mutate(exp_970 = exp_971 + exp_972  + exp_975 + exp_976)\n\n ff_exp&lt;- ff_exp %&gt;% \n  select(-c(exp_971:exp_976)) # drop unwanted columns that are already included in exp_970\n\nff_exp # not labeled\n\n\n\n\nTable 2.2: Pivoted Expenditure Categories ($ Millions). Intermediate step. Not actually used for anything other than having output similar to past STATA output.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>FY2025 Report Images and Tables</span>"
    ]
  },
  {
    "objectID": "Everything_changepensions.html#summary-tables---largest-categories",
    "href": "Everything_changepensions.html#summary-tables---largest-categories",
    "title": "2  FY2025 Report Images and Tables",
    "section": "5.1 Summary Tables - Largest Categories",
    "text": "5.1 Summary Tables - Largest Categories\nThe 10 largest revenue sources and 15 largest expenditure sources remain separate categories and all other smaller sources/expenditures are combined into “All Other Revenues (Expenditures)”. These condensed tables are typically used in the Fiscal Futures articles. They were manually created in past years but this hopefully automates the process a bit until final formatting stages.\n\n\n\nTable 5.5: Largest Revenue Categories with CAGRs\n\n\n\nCode\nn_categories &lt;- 10+1 # (Top 10 and then Total )\n\nrev_majorcats &lt;- rev_long |&gt; \n  filter(Year == current_year | Year == first_year\n         ) |&gt;\n  arrange(desc(Dollars)) |&gt;\n  slice(1:n_categories)\n\nrev_long_majorcats &lt;- rev_long |&gt;\n  mutate(Category_name = ifelse(Category_name %in% rev_majorcats$Category_name, Category_name, \"All Other Sources\"),\n         Category_name = ifelse(Category_name == \"Total\", \"Total Revenue\", Category_name)) |&gt;\n  group_by(Year, Category_name) |&gt; \n  summarize(Dollars = sum(Dollars, na.rm=TRUE))\n\n\n# creates wide version of table where each revenue source is a column\nrevenue_wide_majorcats &lt;- rev_long_majorcats %&gt;% \n  pivot_wider(names_from = Category_name, \n              values_from = Dollars) %&gt;%\n  relocate(\"All Other Sources\", .after = last_col()) %&gt;%\n  relocate(\"Total Revenue\", .after =  last_col())\n\n\n\n\n\n\nCode\nCAGR_revenue_majorcats_tot &lt;- cagr_calculations(rev_long_majorcats) %&gt;%   \n  select(-c(Category_name.1, Category_name.2, Category_name.3, Category_name.4, Category_name.5 )) %&gt;% \n  rename(\"Revenue Category\" = Category_name, \"1 Year CAGR\" = cagr_1, \"2 Year CAGR\" = cagr_2, \"3 Year CAGR\" = cagr_3, \"5 Year CAGR\" = cagr_5, \"10 Year CAGR\" = cagr_10, \"27 Year CAGR\" = cagr_max )\n\nallother_row &lt;- which(grepl(\"All Other\", CAGR_revenue_majorcats_tot$`Revenue Category`))\n\nCAGR_revenue_majorcats_tot &lt;- move_to_last(CAGR_revenue_majorcats_tot, allother_row) # Move \"All Other\" to 2nd to last row\n\ntotalrow &lt;- which(grepl(\"Total\", CAGR_revenue_majorcats_tot$`Revenue Category`))\nCAGR_revenue_majorcats_tot &lt;- move_to_last(CAGR_revenue_majorcats_tot, totalrow) # Move \"Total\" to last row\n\nlastrow = nrow(CAGR_revenue_majorcats_tot)\n\nCAGR_revenue_majorcats_tot %&gt;% \n  kbl(caption = \"CAGR Calculations for Largest Revenue Sources\", row.names = FALSE) %&gt;% \n  kable_classic() %&gt;%\n    row_spec(lastrow, bold = T, color = \"black\", background = \"gray\")\n\n\n\n\nTable 5.6: Top 10 Revenue Sources with CAGRs\n\n\n\n\n\nCAGR Calculations for Largest Revenue Sources\n\n\nRevenue Category\n27 Year CAGR\n10 Year CAGR\n5 Year CAGR\n3 Year CAGR\n2 Year CAGR\n1 Year CAGR\n\n\n\n\nCorporate Income Taxes\n5.01\n5.54\n13.84\n-11.48\n-18.56\n-16.23\n\n\nFederal Medicaid\n6.97\n6.97\n8.26\n2.62\n0.93\n-3.72\n\n\nFederal Other\n4.28\n6.45\n3.65\n-15.71\n3.30\n10.68\n\n\nFederal Transportation\n4.50\n3.04\n8.97\n14.34\n13.86\n16.11\n\n\nIndividual Income Taxes\n5.64\n6.59\n8.98\n4.44\n9.10\n10.03\n\n\nLottery Receipts\n2.10\n1.49\n4.77\n1.66\n-3.09\n-8.88\n\n\nMedical Provider Assessments\n8.33\n9.16\n6.29\n8.07\n7.36\n8.55\n\n\nMotor Fuel Tax\n3.08\n8.61\n4.96\n5.33\n7.22\n4.67\n\n\nMotor Vehicle And Operators\n2.95\n0.63\n2.38\n0.88\n1.33\n0.15\n\n\nPublic Utility Taxes\n0.79\n0.01\n0.74\n1.53\n1.18\n2.65\n\n\nReceipts From Revenue Producing\n5.74\n4.50\n8.61\n11.24\n12.65\n9.05\n\n\nSales Taxes\n3.17\n4.12\n6.35\n2.57\n1.46\n1.67\n\n\nAll Other Sources\n6.04\n6.98\n12.46\n8.79\n4.63\n-0.14\n\n\nTotal Revenue\n4.95\n5.90\n7.95\n0.60\n2.82\n2.64\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n###### Yearly change summary table for Top 10 Revenues #####\nrevenue_change_majorcats &lt;- rev_long_majorcats %&gt;%\n  #select(-c(Category)) %&gt;%\n  filter(Year &gt;= past_year |  Year == first_year) %&gt;%\n  pivot_wider(names_from = Year , values_from = Dollars,   names_prefix = \"Dollars_\") %&gt;%\n    rename(    \n    Dollars_current = Dollars_2025,\n    Dollars_lastyear = Dollars_2024\n    )|&gt;\n  mutate(\n    \"Current FY ($ billions)\" = round(Dollars_current/1000, digits = 2),\n    \"Previous FY ($ billions)\" = round(Dollars_lastyear/1000, digits = 2),\n    \"FY 1998 ($ billions)\" = round(Dollars_1998/1000, digits = 2),\n    \"1-Year Change\" = percent((Dollars_current -Dollars_lastyear)/Dollars_lastyear, accuracy = .01),\n  )  %&gt;%\n  left_join(CAGR_revenue_majorcats_tot, by = c(\"Category_name\" = \"Revenue Category\")\n            ) %&gt;% \n  arrange(-`Current FY ($ billions)`)%&gt;%\n  mutate(`27 Year CAGR` = percent(`27 Year CAGR`/100, accuracy=.01)) %&gt;%\n  select(-c(Dollars_1998, Dollars_current, Dollars_lastyear, `1 Year CAGR`:`10 Year CAGR`\n            )) %&gt;%\n  rename(\"Revenue Category\" = Category_name )\n\nallother_row &lt;- which(grepl(\"All Other\", revenue_change_majorcats$`Revenue Category`))\n\nrevenue_change_majorcats &lt;- move_to_last(revenue_change_majorcats, allother_row) # Move \"All Other\" to 2nd to last row\n\ntotalrow &lt;- which(grepl(\"Total\", revenue_change_majorcats$`Revenue Category`))\nrevenue_change_majorcats &lt;- move_to_last(revenue_change_majorcats, totalrow) # Move \"Total\" to last row\n\nlastrow = nrow(revenue_change_majorcats)\n\nrevenue_change_majorcats%&gt;% \n  kbl(caption = \"Yearly Change in Revenue for Main Revenue Sources\", row.names = FALSE, align = \"l\") %&gt;% \n   kable_classic() %&gt;%\n    row_spec(lastrow, bold = T, color = \"black\", background = \"gray\")\n\n\n\n\nTable 5.7: Top 10 Revenue Sources with CAGRs\n\n\n\n\n\nYearly Change in Revenue for Main Revenue Sources\n\n\nRevenue Category\nCurrent FY ($ billions)\nPrevious FY ($ billions)\nFY 1998 ($ billions)\n1-Year Change\n27 Year CAGR\n\n\n\n\nIndividual Income Taxes\n30.13\n27.38\n6.85\n10.03%\n5.64%\n\n\nFederal Medicaid\n20.58\n21.38\n3.34\n-3.72%\n6.97%\n\n\nSales Taxes\n16.70\n16.43\n7.20\n1.67%\n3.17%\n\n\nFederal Other\n11.61\n10.49\n3.75\n10.68%\n4.28%\n\n\nCorporate Income Taxes\n6.95\n8.30\n1.86\n-16.23%\n5.01%\n\n\nMedical Provider Assessments\n4.71\n4.34\n0.54\n8.55%\n8.33%\n\n\nReceipts From Revenue Producing\n3.29\n3.01\n0.73\n9.05%\n5.74%\n\n\nMotor Fuel Tax\n2.95\n2.82\n1.30\n4.67%\n3.08%\n\n\nFederal Transportation\n2.74\n2.36\n0.84\n16.11%\n4.50%\n\n\nMotor Vehicle And Operators\n1.64\n1.64\n0.75\n0.15%\n2.95%\n\n\nPublic Utility Taxes\n1.48\n1.44\n1.19\n2.65%\n0.79%\n\n\nLottery Receipts\n1.46\n1.61\n0.83\n-8.88%\n2.10%\n\n\nAll Other Sources\n13.92\n13.94\n2.86\n-0.14%\n6.04%\n\n\nTotal Revenue\n118.16\n115.13\n32.03\n2.64%\n4.95%\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nn_categories &lt;- 9 + 1 # (Top 9 and then Total )\n\nexp_majorcats &lt;- exp_long |&gt; \n  filter(Year == current_year | Year == first_year\n         ) |&gt;\n  arrange(desc(Dollars)) |&gt;\n  slice(1:n_categories) # keep top 10 largest categories or categories larger than 2 billion for final table in report (not a set rule, changes each year depending what the focus of the report is or what is highlighted.)\n\n\nexp_long_majorcats &lt;- exp_long |&gt;\n  mutate(Category_name = ifelse(Category_name %in% exp_majorcats$Category_name, Category_name, \"All Other Expenditures **\"),\n         Category_name = ifelse(Category_name == \"Total\", \"Total Expenditures\", Category_name)) |&gt;\n  group_by(Year, Category_name) |&gt; \n  summarize(Dollars = sum(Dollars, na.rm=TRUE))\n\n# expenditure_wide_majorcats &lt;- exp_long_majorcats %&gt;% \n#   pivot_wider(names_from = Category_name, \n#               values_from = Dollars) %&gt;%\n#   relocate(\"All Other Expenditures **\", .after = last_col()) %&gt;%\n#   relocate(\"Total Expenditures\", .after =  last_col())\n\n\n\n# CAGR values for largest expenditure categories and combined All Other Expenditures\n\n\nCAGR_expenditures_majorcats_tot &lt;- cagr_calculations(exp_long_majorcats) |&gt;\n  select(-c(Category_name.1, Category_name.2, Category_name.3, Category_name.4, Category_name.5 )) %&gt;% \n  rename(\"Expenditure Category\" = Category_name, \"1 Year CAGR\" = cagr_1, \"2 Year CAGR\" = cagr_2, \"3 Year CAGR\" = cagr_3, \"5 Year CAGR\" = cagr_5, \"10 Year CAGR\" = cagr_10,\"27 Year CAGR\" = cagr_max )\n\nallother_row &lt;- which(grepl(\"Other\", CAGR_expenditures_majorcats_tot$`Expenditure Category`))\n\nCAGR_expenditures_majorcats_tot &lt;- move_to_last(CAGR_expenditures_majorcats_tot, allother_row) # Move \"All Other\" to 2nd to last row\n\ntotalrow &lt;- which(grepl(\"Total\", CAGR_expenditures_majorcats_tot$`Expenditure Category`))\nCAGR_expenditures_majorcats_tot &lt;- move_to_last(CAGR_expenditures_majorcats_tot, totalrow) # Move \"Total\" to last row\n\nlastrow = nrow(CAGR_expenditures_majorcats_tot)\n\nCAGR_expenditures_majorcats_tot%&gt;%   \n  kbl(caption = \"CAGR Calculations for Largest Expenditure Categories\" , row.names=FALSE) %&gt;% \n     kable_classic()  %&gt;%\n    row_spec(lastrow, bold = T, color = \"black\", background = \"gray\")\n# Yearly change for Top n largest expenditure categories\nexpenditure_change_majorcats &lt;- exp_long_majorcats %&gt;%\n  filter(Year &gt;= past_year |\n           Year == first_year) %&gt;%\n  pivot_wider(names_from = Year , values_from = Dollars,   names_prefix = \"Dollars_\") %&gt;%   \n  rename(    \n    Dollars_current = Dollars_2025,\n    Dollars_lastyear = Dollars_2024\n    )|&gt;\n  mutate(\"Current FY ($ Billions)\" = round(Dollars_current/1000, digits = 2),\n         \"Previous FY ($ Billions)\" = round(Dollars_lastyear/1000, digits = 2),\n         \"FY 1998 ($ Billions)\" = round(Dollars_1998/1000, digits = 2),\n         \"1-Year Change\" = percent((Dollars_current -Dollars_lastyear)/Dollars_lastyear, accuracy = .01),\n         )  %&gt;%\n left_join(CAGR_expenditures_majorcats_tot, by = c(\"Category_name\" = \"Expenditure Category\")) %&gt;% \n  arrange(-`Current FY ($ Billions)`)%&gt;%\n  mutate(`27 Year CAGR` = percent(`27 Year CAGR`/100, accuracy=.01)) %&gt;%\n  select(-c(Dollars_1998, Dollars_current, Dollars_lastyear, `1 Year CAGR`:`10 Year CAGR`\n            )) %&gt;%\n  rename(\n   # \"1-Year Change\" = `1 Year CAGR`,\n    \"27 Year Change\" = `27 Year CAGR`, \n          \"Expenditure Category\" = Category_name )\n\nallother_row &lt;- which(grepl(\"All Other\", expenditure_change_majorcats$`Expenditure Category`))\n\nexpenditure_change_majorcats &lt;- move_to_last(expenditure_change_majorcats, allother_row) # Move \"All Other\" to 2nd to last row\n\ntotalrow &lt;- which(grepl(\"Total\", expenditure_change_majorcats$`Expenditure Category`))\nexpenditure_change_majorcats &lt;- move_to_last(expenditure_change_majorcats, totalrow) # Move \"Total\" to last row\n\nlastrow = nrow(expenditure_change_majorcats)\n\nexpenditure_change_majorcats %&gt;% \n  kbl(caption = \"Yearly Change in Expenditures\", row.names = FALSE, align = \"l\") %&gt;% \n  kable_classic() %&gt;%\n    row_spec(lastrow, bold = T, color = \"black\", background = \"gray\")\n\n\n\n\nTable 5.8: Largest Expenditure Categories with CAGRs\n\n\n\n\n\nCAGR Calculations for Largest Expenditure Categories\n\n\nExpenditure Category\n27 Year CAGR\n10 Year CAGR\n5 Year CAGR\n3 Year CAGR\n2 Year CAGR\n1 Year CAGR\n\n\n\n\nChildren And Family Services\n1.11\n4.59\n7.18\n11.83\n5.36\n-2.37\n\n\nCorrections\n2.21\n2.53\n2.96\n5.82\n2.19\n-2.64\n\n\nDebt Service\n5.32\n-0.26\n0.16\n-0.78\n0.29\n-14.24\n\n\nHuman Services\n3.71\n5.95\n11.89\n13.07\n9.15\n0.49\n\n\nK-12 Education\n4.97\n5.33\n4.53\n2.13\n-0.68\n-4.33\n\n\nLocal Govt Revenue Sharing\n3.58\n3.65\n6.85\n-4.57\n-9.18\n-6.88\n\n\nMedicaid\n7.08\n7.30\n8.95\n6.10\n2.76\n2.33\n\n\nState Employee Healthcare\n6.26\n4.36\n4.76\n7.78\n11.95\n18.97\n\n\nTransportation\n4.55\n3.77\n9.98\n12.83\n11.37\n11.06\n\n\nUniversity Education\n2.91\n2.61\n4.10\n4.33\n3.07\n-1.12\n\n\nAll Other Expenditures **\n4.71\n3.86\n6.72\n3.65\n-3.35\n-1.91\n\n\nOther Departments\n22.33\n6.48\n4.61\n5.21\n8.84\n15.61\n\n\nTotal Expenditures\n4.94\n5.10\n7.09\n4.73\n1.33\n-0.04\n\n\n\n\n\n\n\n\n\n\nYearly Change in Expenditures\n\n\nExpenditure Category\nCurrent FY ($ Billions)\nPrevious FY ($ Billions)\nFY 1998 ($ Billions)\n1-Year Change\n27 Year Change\n\n\n\n\nMedicaid\n34.22\n33.44\n5.40\n2.33%\n7.08%\n\n\nK-12 Education\n20.77\n21.71\n5.60\n-4.33%\n4.97%\n\n\nHuman Services\n10.52\n10.47\n3.93\n0.49%\n3.71%\n\n\nLocal Govt Revenue Sharing\n8.99\n9.66\n3.48\n-6.88%\n3.58%\n\n\nTransportation\n6.57\n5.91\n1.98\n11.06%\n4.55%\n\n\nUniversity Education\n4.96\n5.02\n2.28\n-1.12%\n2.91%\n\n\nState Employee Healthcare\n3.76\n3.16\n0.73\n18.97%\n6.26%\n\n\nOther Departments\n2.15\n1.86\n0.01\n15.61%\n22.33%\n\n\nDebt Service\n1.96\n2.29\n0.48\n-14.24%\n5.32%\n\n\nCorrections\n1.78\n1.83\n0.99\n-2.64%\n2.21%\n\n\nChildren And Family Services\n1.75\n1.79\n1.30\n-2.37%\n1.11%\n\n\nAll Other Expenditures **\n17.53\n17.87\n5.06\n-1.91%\n4.71%\n\n\nTotal Expenditures\n114.96\n115.00\n31.24\n-0.04%\n4.94%",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>FY2025 Report Images and Tables</span>"
    ]
  }
]